<div class="modal fade"
     id="PurchaseEmailModal{{ purchase_order.id }}"
     tabindex="-1">

    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
        <div class="modal-content">

            <!-- Header -->
            <div class="modal-header border-bottom">
                <h5 class="modal-title fw-bold text-dark">
                    Print & Send Mail
                </h5>
                <button type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"></button>
            </div>

            <form method="POST">
                {% csrf_token %}
                <input type="hidden"
                       name="purchase_order_id"
                       value="{{ purchase_order.id }}">
                <input type="hidden"
                       name="job_count"
                       value="{{ purchase_order.pouch_purchase_order_jobs.count }}">

                <div class="modal-body">

                    <!-- ================= MAIN DETAILS ================= -->
                    <h6 class="fw-bold text-dark mb-3">
                        Purchase Order Details
                    </h6>

                    <div class="border rounded p-3 mb-4">
                        <div class="row g-3">

                            <!-- Purchase Order Number -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_pouch_purchase_number"
                                           checked>
                                    <label class="form-check-label fw-bold">
                                        Purchase Order Number
                                    </label>
                                </div>
                                <input type="text"
                                       class="form-control"
                                       name="pouch_purchase_number"
                                       value="{{ purchase_order.pouch_purchase_number }}">
                            </div>

                            <!-- Delivery Date -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_delivery_date"
                                           checked>
                                    <label class="form-check-label fw-bold">
                                        Delivery Date
                                    </label>
                                </div>
                                <input type="date"
                                       class="form-control"
                                       name="delivery_date"
                                       value="{{ purchase_order.delivery_date|date:'Y-m-d' }}">
                            </div>

                            <!-- Party Name -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_party_details"
                                           checked>
                                    <label class="form-check-label fw-bold">
                                        Party Name
                                    </label>
                                </div>
                                <input type="text"
                                       class="form-control bg-light text-dark"
                                       value="{{ purchase_order.party_details.party_name }}"
                                       style="white-space: normal; word-break: break-word;"
                                       readonly>
                                <input type="hidden"
                                       name="party_details"
                                       value="{{ purchase_order.party_details.id }}">
                            </div>

                            <!-- Party Email -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_party_email"
                                           checked>
                                    <label class="form-check-label fw-bold">
                                        Party Email
                                    </label>
                                </div>
                                <input type="email"
                                       class="form-control"
                                       name="party_email"
                                       value="{{ purchase_order.party_email.email }}">
                            </div>

                            <!-- Kind Attention -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_kind_attention"
                                           checked>
                                    <label class="form-check-label fw-bold">
                                        Kind Attention
                                    </label>
                                </div>
                                <input type="text"
                                       class="form-control"
                                       name="kind_attention"
                                       value="{{ purchase_order.party_details.contact_person }}">
                            </div>

                        </div>
                    </div>

                    <!-- ================= JOB DETAILS ================= -->
                    <h6 class="fw-bold text-dark mb-3">
                        Job Details
                    </h6>

                    {% for job in purchase_order.purchase_order_jobs.all %}
                    <div class="border rounded p-3 mb-4">

                        <h6 class="fw-bold text-dark mb-3">
                            Job {{ forloop.counter }}
                        </h6>

                        <input type="hidden"
                               name="job_id[]"
                               value="{{ job.id }}">

                        <div class="row g-3">

                            <!-- Job Name -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_job_name_{{ job.id }}"
                                           checked>
                                    <label class="form-check-label fw-bold">Job Name</label>
                                </div>
                                <input type="text"
                                       class="form-control"
                                       name="job_name_{{ job.id }}"
                                       value="{{ job.job_name }}">
                            </div>

                            <!-- Pouch Open Size -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_pouch_open_size_{{ job.id }}"
                                           checked>
                                    <label class="form-check-label fw-bold">Pouch Open Size</label>
                                </div>
                                <input type="text"
                                       class="form-control"
                                       name="pouch_open_size_{{ job.id }}"
                                       value="{{ job.pouch_open_size }}">
                            </div>

                            <!-- Pouch Combination -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_pouch_combination_{{ job.id }}"
                                           checked>
                                    <label class="form-check-label fw-bold">Pouch Combination</label>
                                </div>
                                <input type="text"
                                       class="form-control"
                                       name="pouch_combination_{{ job.id }}"
                                       value="{{ job.pouch_combination }}">
                            </div>

                            <!-- Quantity -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_quantity_{{ job.id }}"
                                           checked>
                                    <label class="form-check-label fw-bold">Quantity</label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="quantity_{{ job.id }}"
                                       value="{{ job.quantity }}">
                            </div>

                            <!-- Purchase Rate -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_purchase_rate_per_kg_{{ job.id }}"
                                           checked>
                                    <label class="form-check-label fw-bold">
                                        Purchase Rate Per KG
                                    </label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="purchase_rate_per_kg_{{ job.id }}"
                                       value="{{ job.purchase_rate_per_kg }}">
                            </div>

                            <!-- No of Pouch / KG -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_no_of_pouch_kg_{{ job.id }}"
                                           checked>
                                    <label class="form-check-label fw-bold">
                                        No. of Pouch / KG
                                    </label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="no_of_pouch_kg_{{ job.id }}"
                                       value="{{ job.no_of_pouch_kg }}">
                            </div>

                            <!-- Rate Basic -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_per_pouch_rate_basic_{{ job.id }}">
                                    <label class="form-check-label fw-bold">Rate Basic</label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="per_pouch_rate_basic_{{ job.id }}"
                                       value="{{ job.rate_basic }}">
                            </div>

                            <!-- Zipper Cost -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_zipper_cost_{{ job.id }}">
                                    <label class="form-check-label fw-bold">Zipper Cost</label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="zipper_cost_{{ job.id }}"
                                       value="{{ job.zipper_cost }}">
                            </div>

                            <!-- Pouch Charge -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_pouch_charge_{{ job.id }}">
                                    <label class="form-check-label fw-bold">Pouch Charge</label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="pouch_charge_{{ job.id }}"
                                       value="{{ job.pouch_charge }}">
                            </div>

                            <!-- Final Rate -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_final_rate_{{ job.id }}">
                                    <label class="form-check-label fw-bold">Final Rate</label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="final_rate_{{ job.id }}"
                                       value="{{ job.final_rate }}">
                            </div>

                            <!-- Minimum Quantity -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_minimum_quantity_{{ job.id }}">
                                    <label class="form-check-label fw-bold">
                                        Minimum Quantity
                                    </label>
                                </div>
                                <input type="number"
                                       class="form-control"
                                       name="minimum_quantity_{{ job.id }}"
                                       value="{{ job.minimum_quantity }}">
                            </div>

                            <!-- Pouch Type -->
                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_pouch_type_{{ job.id }}">
                                    <label class="form-check-label fw-bold">Pouch Type</label>
                                </div>
                                <input type="text"
                                       class="form-control"
                                       name="pouch_type_{{ job.id }}"
                                       value="{{ job.pouch_type }}">
                            </div>

                            <!-- Delivery Address -->
                            <div class="col-md-6">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_delivery_address_{{ job.id }}">
                                    <label class="form-check-label fw-bold">
                                        Delivery Address
                                    </label>
                                </div>
                                <textarea class="form-control"
                                          rows="2"
                                          name="delivery_address_{{ job.id }}">{{ job.delivery_address }}</textarea>
                            </div>

                            <!-- Special Instruction -->
                            <div class="col-md-6">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_special_instruction_{{ job.id }}">
                                    <label class="form-check-label fw-bold">
                                        Special Instruction
                                    </label>
                                </div>
                                <textarea class="form-control"
                                          rows="2"
                                          name="special_instruction_{{ job.id }}">{{ job.special_instruction }}</textarea>
                            </div>

                        </div>
                    </div>
                    {% endfor %}

                    <!-- ================= OTHER TERMS ================= -->
                    <h6 class="fw-bold text-dark mb-3">
                        Other Terms
                    </h6>

                    <div class="border rounded p-3">
                        <div class="row g-3">

                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_quantity_variate">
                                    <label class="form-check-label fw-bold">
                                        Quantity Variation
                                    </label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="quantity_variate"
                                       value="{{ purchase_order.quantity_variate }}">
                            </div>

                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_freight">
                                    <label class="form-check-label fw-bold">
                                        Freight
                                    </label>
                                </div>
                                <input type="number"
                                       step="0.01"
                                       class="form-control"
                                       name="freight"
                                       value="{{ purchase_order.freight }}">
                            </div>

                            <div class="col-md-4">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_gst">
                                    <label class="form-check-label fw-bold">
                                        GST (%)
                                    </label>
                                </div>
                                <input type="text"
                                       class="form-control"
                                       name="gst"
                                       value="{{ purchase_order.gst }}">
                            </div>

                            <div class="col-12">
                                <div class="form-check mb-1">
                                    <input type="checkbox"
                                           class="form-check-input"
                                           name="check_note">
                                    <label class="form-check-label fw-bold">
                                        Note
                                    </label>
                                </div>
                                <textarea class="form-control"
                                          rows="3"
                                          name="note">{{ purchase_order.note }}</textarea>
                            </div>

                        </div>
                    </div>

                </div>

                <!-- Footer -->
                <div class="modal-footer border-top">
                    <button class="btn btn-outline-secondary"
                            data-bs-dismiss="modal">
                        Close
                    </button>

                    <button class="btn btn-dark"
                            name="send_purchase_order_mail"
                            type="submit">
                        Send Mail
                    </button>

                    <button class="btn btn-outline-dark"
                            name="print_purchase_order"
                            type="submit"
                            formtarget="_blank">
                        Print Purchase Order
                    </button>
                </div>

            </form>
        </div>
    </div>
</div>