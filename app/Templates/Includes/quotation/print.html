{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quotation</title>

<style>
/* ================= PAGE SETUP ================= */
@page {
    size: A4 portrait;
    margin: 10mm;
}

* {
    box-sizing: border-box;
}

html, body {
    margin: 0;
    padding: 0;
}

/* ================= BODY ================= */
body {
    font-family: "Arial", "Helvetica", sans-serif;
    font-size: 11px;
    font-weight: 400;
    line-height: 1.4;
    color: #000;
    background: #fff;
}

/* ================= A4 WRAPPER ================= */
.page {
    width: 210mm;
    min-height: 297mm;
    margin: 0 auto;
    background: #fff;
    padding: 15px;
}

/* ================= HEADER ================= */
.header-wrapper {
    border-bottom: 2px solid #000;
    padding-bottom: 10px;
    margin-bottom: 15px;
}

.header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    padding-bottom: 10px;
    border-bottom: 1px solid #000;
}

.company-logo-section {
    display: flex;
    align-items: center;
    gap: 12px;
}

.company-logo-section img {
    height: 55px;
    width: 55px;
}

.company-title {
    font-size: 18px;
    font-weight: 700;
    text-transform: uppercase;
    color: #000;
}

.company-subtitle {
    font-size: 11px;
    margin-top: 2px;
    color: #000;
}

.quote-badge {
    text-align: right;
}

.quote-label {
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    color: #000;
}

.quote-number {
    font-size: 15px;
    font-weight: 700;
    margin-top: 2px;
    color: #000;
}

.header-bottom {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    gap: 15px;
}

.header-info-col {
    flex: 1;
}

.header-info-col strong {
    display: block;
    margin-bottom: 3px;
    font-size: 11px;
    font-weight: 700;
    color: #000;
}

/* ================= CLIENT SECTION ================= */
.client-section {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #000;
}

.client-box {
    flex: 1;
    border: 1px solid #000;
    padding: 8px;
}

.client-box-title {
    font-size: 11px;
    font-weight: 700;
    color: #000;
    text-transform: uppercase;
    margin-bottom: 5px;
    border-bottom: 1px solid #000;
    padding-bottom: 3px;
}

.client-box-content {
    font-size: 10px;
    line-height: 1.5;
    color: #000;
}

/* ================= PRODUCTS SECTION ================= */
.products-wrapper {
    margin-bottom: 15px;
}

.section-header {
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    margin-bottom: 10px;
    padding: 5px 0;
    border-bottom: 2px solid #000;
    color: #000;
}

.product-card {
    border: 1px solid #000;
    margin-bottom: 15px;
    page-break-inside: avoid;
}

.product-header {
    padding: 6px 10px;
    border-bottom: 1px solid #000;
    background: #f5f5f5;
}

.product-name {
    font-size: 12px;
    font-weight: 700;
    color: #000;
}

.product-body {
    padding: 10px;
}

.special-note {
    border: 1px solid #000;
    padding: 6px;
    margin-bottom: 10px;
}

.special-note-title {
    font-weight: 700;
    color: #000;
    margin-bottom: 4px;
    font-size: 10px;
    text-transform: uppercase;
}

.special-note-text {
    color: #000;
    font-size: 10px;
    line-height: 1.4;
}

.specs-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 5px;
}

.specs-table td {
    padding: 4px 6px;
    border: 1px solid #000;
    font-size: 10px;
}

.specs-table td:first-child {
    font-weight: 600;
    width: 40%;
    background: #f5f5f5;
    color: #000;
}

.specs-table td:last-child {
    width: 60%;
    color: #000;
}

/* ================= TERMS SECTION ================= */
.terms-wrapper {
    border: 1px solid #000;
    padding: 10px;
    margin-bottom: 15px;
}

.terms-title {
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    margin-bottom: 8px;
    border-bottom: 1px solid #000;
    padding-bottom: 4px;
    color: #000;
}

.terms-table {
    width: 100%;
    border-collapse: collapse;
}

.terms-table td {
    padding: 4px 6px;
    border: 1px solid #000;
    font-size: 10px;
    color: #000;
}

.terms-table td:first-child {
    font-weight: 600;
    width: 30%;
    background: #f5f5f5;
}

/* ================= FOOTER ================= */
.footer-section {
    border-top: 2px solid #000;
    padding-top: 12px;
    margin-top: 15px;
}

.footer-content {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
}

.footer-left {
    flex: 1;
}

.thank-you {
    font-size: 14px;
    font-weight: 700;
    color: #000;
    margin-bottom: 5px;
}

.footer-company {
    font-size: 10px;
    color: #000;
    line-height: 1.5;
}

.signature-area {
    text-align: center;
    min-width: 180px;
}

.signature-line {
    border-bottom: 1px solid #000;
    margin-bottom: 6px;
    padding-bottom: 5px;
}

.signature-line img {
    height: 70px;
    width: auto;
}

.signature-name {
    font-weight: 700;
    font-size: 11px;
    color: #000;
    text-transform: uppercase;
}

.signature-title {
    font-size: 9px;
    color: #000;
    margin-top: 2px;
}

/* ================= PRINT FIX ================= */
@media print {
    body {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }
    
    .product-card {
        page-break-inside: avoid;
    }
}
</style>
</head>

<body>
<div class="page">

<!-- HEADER -->
<div class="header-wrapper">
    <div class="header-top">
        <div class="company-logo-section">
            <img src="{% static 'assets/img/logo_icon.png' %}" alt="Logo">
            <div>
                <div class="company-title">Shrri Nirmal Ventures</div>
                <div class="company-subtitle">Private Limited</div>
            </div>
        </div>
        <div class="quote-badge">
            <div class="quote-label">Quotation No.</div>
            <div class="quote-number">{{ common_values.pouch_quotation_number }}</div>
        </div>
    </div>
    
    <div class="header-bottom">
        <div class="header-info-col">
            <strong>Corporate Office</strong>
            Unit 1601, 16th Floor, B Block,<br>
            Navratna Corporate Park, Ambli Bopal Road,<br>
            Ahmedabad - 380058
        </div>
        <div class="header-info-col">
            <strong>Contact Information</strong>
            Email: info@shrrinirmal.com<br>
            Mobile: +91 9909045775<br>
            GSTIN: 24AABCN6372N1Z4
        </div>
        <div class="header-info-col">
            <strong>Date</strong>
            {% now "d-m-Y" %}
        </div>
    </div>
</div>

<!-- CLIENT SECTION -->
<div class="client-section">
    <div class="client-box">
        <div class="client-box-title">To</div>
        <div class="client-box-content">
            {{ common_values.party_details }}
        </div>
    </div>
    <div class="client-box">
        <div class="client-box-title">Kind Attention</div>
        <div class="client-box-content">
            {{ common_values.kind_attention }}
        </div>
    </div>
</div>

<!-- PRODUCTS -->
<div class="products-wrapper">
    <div class="section-header">Product Details</div>
    
    {% for job in jobs %}
    <div class="product-card">
        <div class="product-header">
            <span class="product-name">{{ job.job_name|default:"Product Name" }}</span>
        </div>
        
        <div class="product-body">
            {% if job.special_instruction %}
            <div class="special-note">
                <div class="special-note-title">Note</div>
                <div class="special-note-text">{{ job.special_instruction }}</div>
            </div>
            {% endif %}
            
            <table class="specs-table">
                {% if job.pouch_open_size %}
                <tr>
                    <td>Pouch Open Size</td>
                    <td>{{ job.pouch_open_size }}</td>
                </tr>
                {% endif %}
                
                {% if job.pouch_combination %}
                <tr>
                    <td>Pouch Combination</td>
                    <td>{{ job.pouch_combination }}</td>
                </tr>
                {% endif %}
                
                {% if job.quantity %}
                <tr>
                    <td>Quantity</td>
                    <td>{{ job.quantity }}</td>
                </tr>
                {% endif %}
                
                {% if job.minimum_quantity %}
                <tr>
                    <td>Minimum Quantity</td>
                    <td>{{ job.minimum_quantity }}</td>
                </tr>
                {% endif %}
                
                {% if job.per_pouch_rate_basic %}
                <tr>
                    <td>Per Pouch Rate (Basic)</td>
                    <td>₹ {{ job.per_pouch_rate_basic }}</td>
                </tr>
                {% endif %}
                
                {% if job.no_of_pouch_kg %}
                <tr>
                    <td>Pouches per Kg</td>
                    <td>{{ job.no_of_pouch_kg }}</td>
                </tr>
                {% endif %}
                
                {% if job.zipper_cost %}
                <tr>
                    <td>Zipper Cost</td>
                    <td>₹ {{ job.zipper_cost }}</td>
                </tr>
                {% endif %}
                
                {% if job.pouch_charge %}
                <tr>
                    <td>Pouch Charge</td>
                    <td>₹ {{ job.pouch_charge }}</td>
                </tr>
                {% endif %}
                
                {% if job.purchase_rate_per_kg %}
                <tr>
                    <td>Purchase Rate per Kg</td>
                    <td>₹ {{ job.purchase_rate_per_kg }}</td>
                </tr>
                {% endif %}
                
                {% if job.final_rare %}
                <tr>
                    <td>Final Rate</td>
                    <td>₹ {{ job.final_rare }}</td>
                </tr>
                {% endif %}
                
                {% if job.pouch_type %}
                <tr>
                    <td>Pouch Type</td>
                    <td>{{ job.pouch_type }}</td>
                </tr>
                {% endif %}
            </table>
            
            {% if job.delivery_address %}
            <div class="special-note" style="margin-top: 10px;">
                <div class="special-note-title">Delivery Address</div>
                <div class="special-note-text" style="white-space: pre-line;">{{ job.delivery_address }}</div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>

<!-- TERMS -->
<div class="terms-wrapper">
    <div class="terms-title">Other Terms</div>
    <table class="terms-table">
        <tr>
            <td>Quantity Variate</td>
            <td>{{ common_values.quantity_variate }}</td>
            <td><b>Freight</b></td>
            <td>{{ common_values.freight }}</td>
        </tr>
        <tr>
            <td><b>G.S.T.</b></td>
            <td>{{ common_values.gst }}</td>
            <td><b>Term Note</b></td>
            <td>{{ common_values.note }}</td>
        </tr>
    </table>
</div>

<!-- FOOTER -->
<div class="footer-section">
    <div class="footer-content">
        <div class="footer-left">
            <div class="thank-you">Thank You For Your Business!</div>
            <div class="footer-company">
                <strong>Shrri Nirmal Ventures Private Limited</strong><br>
                We look forward to serving you again.
            </div>
        </div>
        <div class="signature-area">
            <div class="signature-line">
                <img src="{% static 'assets/img/BHAVIKsir_SIGN.jpg' %}" alt="Signature">
            </div>
            <div class="signature-name">Mr. Bhavik Shah</div>
            <div class="signature-title">Authorized Signatory</div>
        </div>
    </div>
</div>

</div>

<script>
window.onload = function () {
    window.print();
    window.onafterprint = function () {
        window.close();
    };
};
</script>

</body>
</html>