<div
    class="modal fade"
    id="PurchaseQuotationModal{{ quotation.id }}"
    tabindex="-1"
>
    <div
        class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl"
    >
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title fw-bold">Purchase Order & Send Mail</h5>
                <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                ></button>
            </div>

            <form method="POST">
                {% csrf_token %}
                <input
                    type="hidden"
                    name="quotation_id"
                    value="{{ quotation.id }}"
                />
                <input
                    type="hidden"
                    name="job_count"
                    value="{{ quotation.pouch_quotation_jobs.count }}"
                />

                <div class="modal-body">
                    <!-- ===================== MAIN DETAILS (COMMON) ===================== -->
                    <h6 class="fw-bold text-primary">Purchase Order Details</h6>

                    <div class="border rounded p-3 mb-3">
                        <div class="row g-3">
                            <!-- Delivery Date -->
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_delivery_date"
                                        name="check_delivery_date"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Delivery Date</label
                                    >
                                </div>
                                <input
                                    type="date"
                                    class="form-control"
                                    name="delivery_date"
                                    value="{{ quotation.delivery_date|date:'Y-m-d' }}"
                                />
                            </div>

                            <!-- Party -->
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_party_details"
                                        name="check_party_details"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Party</label
                                    >
                                </div>
                                <input
                                    type="text"
                                    class="form-control"
                                    value="{{ quotation.party_details.party_name }}"
                                    disabled
                                />
                                <input
                                    type="hidden"
                                    name="party_details"
                                    value="{{ quotation.party_details.id }}"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- ===================== JOB DETAILS (MULTIPLE) ===================== -->
                    <h6 class="fw-bold text-primary">Job Details</h6>

                    {% for job in quotation.pouch_quotation_jobs.all %}
                    <div class="border rounded p-3 mb-3">
                        <h6 class="fw-bold text-secondary">
                            Job {{ forloop.counter }}
                        </h6>

                        <input
                            type="hidden"
                            name="job_id"
                            value="{{ job.id }}"
                        />

                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_job_name"
                                        name="check_job_name"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Job Name</label
                                    >
                                </div>
                                <input
                                    type="text"
                                    class="form-control"
                                    name="job_name"
                                    value="{{ job.job_name }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_pouch_open_size"
                                        name="check_pouch_open_size"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Pouch Size (Open)</label
                                    >
                                </div>
                                <input
                                    type="text"
                                    class="form-control"
                                    name="pouch_open_size"
                                    value="{{ job.pouch_open_size }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_pouch_combination"
                                        name="check_pouch_combination"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Pouch Combination</label
                                    >
                                </div>
                                <input
                                    type="text"
                                    class="form-control"
                                    name="pouch_combination"
                                    value="{{ job.pouch_combination }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_quantity"
                                        name="check_quantity"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Quantity</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="quantity"
                                    value="{{ job.quantity }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_purchase_rate"
                                        name="check_purchase_rate_per_kg"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Purchase Rate / KG (₹)</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="purchase_rate_per_kg"
                                    value="{{ job.purchase_rate_per_kg }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_no_of_pouch"
                                        name="check_no_of_pouch_kg"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >No. of Pouch / KG</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="no_of_pouch_kg"
                                    value="{{ job.no_of_pouch_kg }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_per_pouch_rate"
                                        name="check_per_pouch_rate_basic"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Per Pouch Rate</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="per_pouch_rate_basic"
                                    value="{{ job.per_pouch_rate_basic }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_zipper_cost"
                                        name="check_zipper_cost"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Zipper Cost</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="zipper_cost"
                                    value="{{ job.zipper_cost }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_pouch_charge"
                                        name="check_pouch_charge"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Pouch Charge</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="pouch_charge"
                                    value="{{ job.pouch_charge }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_final_rate"
                                        name="check_final_rate"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Final Rate</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="final_rate"
                                    value="{{ job.final_rare }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_minimum_quantity"
                                        name="check_minimum_quantity"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Minimum Quantity</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    class="form-control"
                                    name="minimum_quantity"
                                    value="{{ job.minimum_quantity }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_pouch_type"
                                        name="check_pouch_type"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Pouch Type</label
                                    >
                                </div>
                                <input
                                    type="text"
                                    class="form-control"
                                    name="pouch_type"
                                    value="{{ job.pouch_type }}"
                                />
                            </div>

                            <div class="col-md-6">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_delivery_address"
                                        name="check_delivery_address"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Delivery Address</label
                                    >
                                </div>
                                <textarea
                                    class="form-control"
                                    rows="2"
                                    name="delivery_address"
                                >
                            {{ job.delivery_address }}</textarea
                                >
                            </div>

                            <div class="col-md-6">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_special_instruction"
                                        name="check_special_instruction"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Special Instruction</label
                                    >
                                </div>
                                <textarea
                                    class="form-control"
                                    rows="2"
                                    name="special_instruction"
                                >
                                {{ job.special_instruction }}</textarea
                                >
                            </div>
                        </div>
                    </div>
                    {% endfor %}

                    <!-- ===================== OTHER TERMS ===================== -->
                    <h6 class="fw-bold text-primary">Other Terms</h6>

                    <div class="border rounded p-3 mb-3">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_quantity_variate"
                                        name="check_quantity_variate"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Quantity Variation (%)</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="quantity_variate"
                                    value="{{ quotation.quantity_variate }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_freight"
                                        name="check_freight"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Freight (₹)</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    step="0.01"
                                    class="form-control"
                                    name="freight"
                                    value="{{ quotation.freight }}"
                                />
                            </div>

                            <div class="col-md-4">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_gst"
                                        name="check_gst"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >GST (%)</label
                                    >
                                </div>
                                <input
                                    type="number"
                                    class="form-control"
                                    name="gst"
                                    value="{{ quotation.gst }}"
                                />
                            </div>

                            <div class="col-md-12">
                                <div class="form-check">
                                    <input
                                        type="checkbox"
                                        class="form-check-input"
                                        id="check_note"
                                        name="check_note"
                                    />
                                    <label class="form-check-label fw-semibold"
                                        >Note</label
                                    >
                                </div>
                                <textarea class="form-control" name="note">
                                    {{ quotation.note }}</textarea
                                >
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-info" data-bs-dismiss="modal">
                        Close
                    </button>

                    <button
                        class="btn btn-primary"
                        name="create_purchase_order"
                        type="submit"
                    >
                        Create Purchase Order
                    </button>

                    <button
                        class="btn btn-success"
                        name="send_quotation_mail"
                        type="submit"
                    >
                        Send Mail
                    </button>

                    <button
                        type="button"
                        class="btn btn-dark"
                        onclick="printSelectedFields()"
                    >
                        Print Selected
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
